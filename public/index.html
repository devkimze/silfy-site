<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Silfyxd — Social Status</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
  body {
    font-family: 'Poppins', sans-serif;
    background-color: #0e0e10;
    color: #fff;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 50px 0;
    gap: 20px;
  }

  .social-item {
    position: relative;
    width: 340px;
    background: #1a1a1d;
    border-radius: 15px;
    padding: 20px 25px;
    display: flex;
    align-items: center;
    transition: all 0.25s ease;
    cursor: pointer;
    overflow: hidden;
  }
  .social-item:hover {
    transform: scale(1.03);
    background-color: #232326;
    box-shadow: 0 0 12px rgba(255,255,255,0.15);
  }

  .platform-label {
    position: absolute;
    top: 10px;
    right: 15px;
    font-size: 12px;
    font-weight: 600;
    padding: 3px 8px;
    border-radius: 8px;
    backdrop-filter: blur(4px);
  }

  .discord-label { background: rgba(88,101,242,0.15); color: #7289da; }
  .tiktok-label { background: rgba(255,44,85,0.15); color: #ff2c55; }
  .youtube-label { background: rgba(255,0,0,0.15); color: #ff4444; }

  .avatar {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    object-fit: cover;
    margin-right: 15px;
  }

  .social-info {
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  .username {
    font-weight: 600;
    font-size: 18px;
    margin: 0;
  }

  .status {
    font-size: 14px;
    color: #aaa;
    margin-top: 3px;
  }

  .status-dot {
    position: absolute;
    bottom: 10px;
    left: 60px;
    width: 14px;
    height: 14px;
    border-radius: 50%;
    border: 2px solid #1a1a1d;
  }

  .online { background-color: #43b581; }
  .idle { background-color: #faa61a; }
  .dnd { background-color: #f04747; }
  .offline { background-color: #747f8d; }
</style>
</head>
<body>

  <!-- Discord 카드 -->
  <div class="social-item discord" id="discordCard">
    <div class="platform-label discord-label">Discord</div>
    <img id="discordAvatar" class="avatar" src="" alt="Discord Avatar">
    <div class="status-dot offline" id="discordStatusDot"></div>
    <div class="social-info">
      <p class="username" id="discordName">Loading...</p>
      <p class="status" id="discordActivity">불러오는 중...</p>
    </div>
  </div>

  <!-- TikTok 카드 -->
  <div class="social-item tiktok" id="tiktokCard">
    <div class="platform-label tiktok-label">TikTok</div>
    <img id="tiktokAvatar" class="avatar" src="" alt="TikTok Avatar">
    <div class="social-info">
      <p class="username" id="tiktokName">@silfyxd</p>
      <p class="status" id="tiktokStats">followers • likes</p>
    </div>
  </div>

  <!-- YouTube 카드 -->
  <div class="social-item youtube" id="youtubeCard">
    <div class="platform-label youtube-label">YouTube</div>
    <img id="youtubeAvatar" class="avatar" src="" alt="YouTube Avatar">
    <div class="social-info">
      <p class="username" id="youtubeName">지후7</p>
      <p class="status" id="youtubeStats">구독자 • 조회수</p>
    </div>
  </div>

<script>
const DISCORD_USER_ID = "여기에_디스코드_유저_ID_입력"; // 예: "120342156765432345"
const TIKTOK_URL = "https://www.tiktok.com/@silfyxd";
const YOUTUBE_URL = "https://www.youtube.com/@지후7";

// ==== Discord ====
async function fetchDiscord() {
  try {
    const res = await fetch(`/api/discord-status/${DISCORD_USER_ID}?_=${Date.now()}`);
    const data = await res.json();
    document.getElementById("discordAvatar").src = data.avatar_url;
    document.getElementById("discordName").textContent = data.username;

    const dot = document.getElementById("discordStatusDot");
    dot.className = `status-dot ${data.status}`;

    if (data.activity) {
      if (data.activity.name === "Spotify") {
        document.getElementById("discordActivity").textContent = 
          `${data.activity.details} - ${data.activity.state}`;
      } else {
        document.getElementById("discordActivity").textContent = 
          `${data.activity.name}${data.activity.state ? " — " + data.activity.state : ""}`;
      }
    } else {
      document.getElementById("discordActivity").textContent = "현재 활동 없음";
    }
  } catch {
    document.getElementById("discordActivity").textContent = "불러오기 실패";
  }
}

// ==== TikTok ====
async function fetchTikTok() {
  try {
    const res = await fetch(`/api/tiktok?_=${Date.now()}`);
    const data = await res.json();
    document.getElementById("tiktokAvatar").src = data.avatar;
    document.getElementById("tiktokName").textContent = `@${data.username}`;
    document.getElementById("tiktokStats").textContent = 
      `${data.followers.toLocaleString()} followers • ${data.likes.toLocaleString()} likes`;
  } catch {
    document.getElementById("tiktokStats").textContent = "불러오기 실패";
  }
}

// ==== YouTube ====
async function fetchYouTube() {
  try {
    const res = await fetch(`/api/youtube?_=${Date.now()}`);
    const data = await res.json();
    document.getElementById("youtubeAvatar").src = data.thumbnail;
    document.getElementById("youtubeName").textContent = data.title;
    document.getElementById("youtubeStats").textContent =
      `${Number(data.subscribers).toLocaleString()}명 구독자`;
  } catch {
    document.getElementById("youtubeStats").textContent = "불러오기 실패";
  }
}

// ==== 리다이렉트 ====
document.getElementById("tiktokCard").addEventListener("click", () => window.open(TIKTOK_URL, "_blank"));
document.getElementById("youtubeCard").addEventListener("click", () => window.open(YOUTUBE_URL, "_blank"));

// ==== 실행 및 주기적 갱신 ====
function refreshAll() {
  fetchDiscord();
  fetchTikTok();
  fetchYouTube();
}
refreshAll();
setInterval(refreshAll, 60000);
</script>
</body>
</html>
